#!/bin/bash

LOG_FILE="/tmp/1672396-linux-monitoring-database-query-performance/db_queries.log"

count=0
line_num=0

while IFS= read -r line; do
  ((line_num++))
  case $((line_num % 3)) in
    1) datetime="$line" ;;
    2) query_id="$line" ;;
    0)
      exec_time=$(echo "$line" | awk '{print $1}')
      status=$(echo "$line" | awk '{print $2}' | xargs)  # trim whitespace

      if [[ "$status" == "SUCCESS" && "$exec_time" -gt 2000 ]]; then
        ((count++))
      fi
      ;;
  esac
done < "$LOG_FILE"

echo "$count"