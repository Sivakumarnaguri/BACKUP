---
- name: Deploy PHP Example Stack
  hosts: localhost
  become: true
  tasks:

    - name: Start MySQL container
      docker_container:
        name: db
        image: mysql:5.7
        state: started
        restart_policy: always
        env:
          MYSQL_ROOT_PASSWORD: root
          MYSQL_DATABASE: example
        ports:
          - "3306:3306"

    - name: Start PHP Example Web container
      docker_container:
        name: web
        image: problemsetters/801133-ansible
        state: started
        restart_policy: always
        links:
          - db
        ports:
          - "8000:80"